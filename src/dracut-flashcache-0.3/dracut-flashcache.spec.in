Summary: Dracut modules to build a dracut initramfs with flashcache support
Name: dracut-flashcache
Version: %{ver}
%if %{rel}
Release: %{rel}%{?dist:%{dist}}
%else
Release: 1%{?dist:%{dist}}
%endif
Group: System Environment/Base
Source0: %{name}-%{ver}.tgz
License: GPL
BuildRoot: %{_tmppath}/%{name}-root
Packager: John Newbign (jnewbigin@chrysocome.net)
Vendor: Chrysocome
Requires: dracut
Requires: flashcache-utils
Requires: kmod-flashcache
BuildArch: noarch

%description
This package enables creating and starting flashcache in initrd
so you can use flashcache on your root filesystem or physical volumes.

It also enables using flashcache on other disks which are set up
during rc.sysinit (via udev).

%prep
%setup 

%build

%install
[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf $RPM_BUILD_ROOT

mkdir -p $RPM_BUILD_ROOT/sbin/
mkdir -p $RPM_BUILD_ROOT/lib/udev/rules.d/
mkdir -p $RPM_BUILD_ROOT/usr/share/dracut/modules.d/

cp fc_scan $RPM_BUILD_ROOT/sbin/
cp 10-flashcache.rules $RPM_BUILD_ROOT/lib/udev/rules.d/
cp -r 90flashcache $RPM_BUILD_ROOT/usr/share/dracut/modules.d/

%files
%defattr(-,root,root,0755)
/sbin/fc_scan
/lib/udev/rules.d/10-flashcache.rules
/usr/share/dracut/modules.d/
%doc README
%doc COPYING

%changelog
* Mon Dec 3 2012 John Newbign <jnewbigin@chrysocome.net> - 0.3
- Fix up a few fc_scan bugs
- Add mode none
* Sat Jul 14 2012 John Newbigin <jnewbigin@chrysocome.net> - 0.2
- Add scripts for the real udev
* Sun Jun 03 2012 John Newbigin <jnewbigin@chrysocome.net> - 0.1
- First cut

